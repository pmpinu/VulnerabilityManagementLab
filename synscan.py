#! usr/bin/env python

from scapy.all import *
import ipaddress

# Defining the ports to be scanned in a list.
ports = [53, 80, 25, 22, 443, 445, 6000, 6667, 8009, 8180, 5900, 5432]

# Defining a function for the SYN scan. The sr() function will send and receive packets to and from the specified host on ports defined above. 
# Received packets will be stored in the "reply" list. If packets received back from the host are from the same port # as packets sent from the
# client port AND the packet has flags SYN/ACK set, the port # is printed.
def SynScan(host):
	reply, noreply = sr(IP(dst=host)/TCP(sport=33453, dport=ports, flags="S"), timeout=2, verbose=0)
	print("Open ports for %s:" % host)
	
	for(s,r,) in reply:
		if s[TCP].dport == r[TCP].sport and r[TCP].flags=="SA":
			print(s[TCP].dport)

# Defining host as an user input IP address.			
host = input("Enter host IP address: ")
try:
	ipaddress.ip_address(host)	
except:
	print("invalid address")
	exit(-1)
	
SynScan(host)
